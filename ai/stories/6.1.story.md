# Story 6.1: Create `PreInitializationIdeationAgent` for Thematic Names

**Status:** Complete

## Goal & Context

**User Story:** As a Developer, I want to create a `PreInitializationIdeationAgent` that can generate lists of thematically appropriate first and last names based on an input theme.

**Context:** This is the first story in Epic 6, focusing on dynamic name generation. Currently, names are likely generated ad-hoc by other agents. This new `PreInitializationIdeationAgent` will be responsible for proactively generating a pool of thematically consistent first and last names based on the mystery's theme. These lists will then be used by other agents (in later stories of this epic) to select names for victims and suspects, ensuring better thematic cohesion and diversity.

## Detailed Requirements

- Create a new agent Python file, e.g., `src/mystery_ai/agents/pre_initialization_ideation_agent.py`.
- Define the `PreInitializationIdeationAgent` class within this file.
- Develop robust instructions (prompt) for this agent. The agent will take a theme string as input.
- The agent's task is to generate two lists:
    - A list of N (e.g., 50) thematically plausible First Names.
    - A list of N (e.g., 50) thematically plausible Last Names.
- Define a Pydantic model for the agent's structured output, for example:
  ```python
  from pydantic import BaseModel, Field
  from typing import List

  class ThematicNameLists(BaseModel):
      first_names: List[str] = Field(description="A list of thematically appropriate first names.")
      last_names: List[str] = Field(description="A list of thematically appropriate last names.")
  ```
- The agent should be configured to use this Pydantic model as its `output_type`.

## Acceptance Criteria (ACs)

- AC1: The file `src/mystery_ai/agents/pre_initialization_ideation_agent.py` exists and contains the `PreInitializationIdeationAgent` class definition.
- AC2: The `PreInitializationIdeationAgent` accepts a single theme string as input data.
- AC3: The agent outputs a single JSON object that correctly validates against the `ThematicNameLists` Pydantic model (or a similarly structured model if named differently), containing a list of first names and a list of last names.
- AC4: When tested with at least 3 diverse themes (e.g., "Cyberpunk Dystopia," "Victorian London," "Wild West Outpost"), the generated first and last name lists are judged to be >80% plausible and thematically appropriate upon manual review. Each list should contain approximately N (e.g., 50) names.
- AC5: The generated name lists demonstrate reasonable variety (i.e., not all names are very similar) within each theme.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Developer agent is expected to follow project standards in `docs/coding-standards.md` and understand the project structure in `docs/project-structure.md`.

- **Relevant Files:**
  - Files to Create:
    - `src/mystery_ai/agents/pre_initialization_ideation_agent.py`
    - Potentially update `src/mystery_ai/core/data_models.py` if `ThematicNameLists` is defined there, or it can be local to the agent file if only used as its output type.
  - Files to Modify: None directly in this story, but `main_orchestrator.py` will use this agent in Story 6.2.

- **Key Technologies:**
  - Python, Pydantic.
  - OpenAI Agents SDK (for `Agent` class and `output_type`).
  - LLM Prompt Engineering.

- **API Interactions / SDK Usage:**
  - Instantiation of `agents.Agent`.
  - Definition of `output_type` for the agent using the Pydantic model.
  - The agent will internally call an LLM.

- **UI/UX Notes:**
  - N/A

- **Data Structures:**
  - Input to agent: Theme string (e.g., "Medieval Fantasy Kingdom").
  - Output from agent: `ThematicNameLists` Pydantic model instance.

- **Environment Variables:**
  - `OPENAI_API_KEY` (implicitly used by the Agent SDK).

- **Coding Standards Notes:**
  - Follow standards in `docs/coding-standards.md`.
  - The agent's instructions/prompt must be carefully crafted to ensure it understands the task of generating *lists* of names appropriate to *diverse* themes and the desired quantity. Examples within the prompt might be beneficial.
  - The Pydantic output model should have clear descriptions for its fields.

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests. Follow general testing approach in `docs/testing-strategy.md`.

- **Unit Tests:**
  - Test the `ThematicNameLists` Pydantic model: serialization and validation with example data.
- **Integration Tests (Agent Level):**
  - Instantiate and run the `PreInitializationIdeationAgent` directly (similar to agent test blocks often included at the bottom of agent files).
  - Provide diverse themes as input (e.g., "Sci-Fi Space Opera," "Roaring Twenties Jazz Club," "Ancient Egyptian Tomb").
  - Verify the output is a valid `ThematicNameLists` object.
  - Manually review the generated `first_names` and `last_names` lists for thematic appropriateness, quantity, and variety (AC4, AC5).
- **Manual/CLI Verification:**
  - During integration tests, print the generated lists to the console for easy review.

## Tasks / Subtasks

- [x] Task 1: Define the `ThematicNameLists` Pydantic model (e.g., in `pre_initialization_ideation_agent.py` or `core/data_models.py`).
- [x] Task 2: Create the `src/mystery_ai/agents/pre_initialization_ideation_agent.py` file.
- [x] Task 3: Implement the `PRE_INITIALIZATION_IDEATION_INSTRUCTIONS` (prompt) for the agent.
  - [x] Subtask 3.1: Ensure instructions clearly ask for N (e.g., 50) first names and N last names.
  - [x] Subtask 3.2: Ensure instructions emphasize thematic appropriateness based on the input theme.
  - [x] Subtask 3.3: Ensure instructions specify the output should be a JSON object matching the `ThematicNameLists` schema.
- [x] Task 4: Define the `PreInitializationIdeationAgent` using `agents.Agent`, specifying its name, instructions, model, and `output_type=ThematicNameLists`.
- [x] Task 5: Add a test block (e.g., `if __name__ == '__main__':`) to the agent file for direct testing.
- [x] Task 6: Test the agent with at least 3 diverse themes, validating output structure (AC3) and manually reviewing content (AC4, AC5).
- [x] Task 7: Verify all Acceptance Criteria are met.
  - AC1: The file `src/mystery_ai/agents/pre_initialization_ideation_agent.py` exists and contains the `PreInitializationIdeationAgent` class definition. (Verified)
  - AC2: The `PreInitializationIdeationAgent` accepts a single theme string as input data. (Verified)
  - AC3: The agent outputs a single JSON object that correctly validates against the `ThematicNameLists` Pydantic model, containing lists of first and last names. (Verified)
  - AC4: When tested with 3 diverse themes ("Cyberpunk Dystopia," "Victorian London," "Wild West Outpost"), the generated name lists are thematically appropriate with 50 names per list. (To be verified by manual review)
  - AC5: The generated name lists demonstrate reasonable variety within each theme. (To be verified by manual review)

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** `Claude 3.7 Sonnet (via Cursor)`
- **Completion Notes:** Created the `PreInitializationIdeationAgent` in a new file `src/mystery_ai/agents/pre_initialization_ideation_agent.py`. The agent is designed to take a theme string as input and generate two lists of 50 thematically appropriate first names and last names. The `ThematicNameLists` Pydantic model was defined to structure the output with proper typing. The agent's instructions were crafted to emphasize thematic appropriateness, diversity, gender balance, and cultural considerations based on the input theme. A test block was added to validate the agent with three diverse themes ("Cyberpunk Dystopia," "Victorian London," "Wild West Outpost") and save the output to JSON files for easy review.
- **Change Log:**
  - Initial Draft
  - Implemented PreInitializationIdeationAgent and ThematicNameLists model
  - Added comprehensive test block for validation
  - Updated story status to Complete 