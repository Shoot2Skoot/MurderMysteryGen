# Story 5.4: Data Model Updates for Attribute Tracking (Optional)

**Status:** Draft

## Goal & Context

**User Story:** As a Developer, I want to update the `VictimProfile` (and `SuspectProfile` if applicable) Pydantic models to include optional fields for explicitly storing the *category* of the chosen attributes, if deemed necessary for downstream processing or debugging.

**Context:** This story addresses a potential need for more explicit data tracking. While Story 5.3 focuses on thematic integration of selected attributes into existing descriptive fields, this story considers adding new, specific fields to the Pydantic models (`VictimProfile`, `SuspectProfile`) to store the exact category name of the chosen attributes (e.g., which specific "Motive Category" was picked from the list). This is an optional enhancement based on discussion.

## Detailed Requirements

- **Decision Point:** The development team (including Product Owner/Scrum Master) needs to discuss and decide if explicitly tracking the *category* of chosen attributes (Cause of Death, Motive, Occupation, Personality) in separate Pydantic model fields is necessary.
    -   Considerations: Will this data be useful for downstream analytics, debugging, fine-tuning prompts, or other future features? Is thematic integration into descriptive text sufficient?
- If the decision is **YES** to add explicit tracking fields:
    - Add new optional fields to `VictimProfile` in `core/data_models.py` (e.g., `chosen_cause_of_death_category: Optional[str] = None`, `chosen_motive_category: Optional[str] = None`, etc.).
    - If `SuspectProfile` is also to be similarly augmented (e.g., for chosen occupation/personality archetypes if those are applied to suspects later), update it as well.
    - Modify `CaseInitializationAgent` (and `SuspectGenerationAgent` if applicable) to populate these new fields with the name of the category selected from the input sub-lists.
- If the decision is **NO**, this story primarily involves documenting that decision, and no code changes are made.

## Acceptance Criteria (ACs)

- AC1: A clear decision on the necessity of explicit attribute category tracking fields in Pydantic models is made and documented (e.g., in this story's completion notes or a design note).
- AC2: (If decision is YES) `VictimProfile` model in `core/data_models.py` is updated with new optional fields for each of the four chosen attribute categories (e.g., `chosen_cause_of_death_category: Optional[str]`).
- AC3: (If decision is YES and applies to suspects) `SuspectProfile` model is similarly updated.
- AC4: (If decision is YES) The `CaseInitializationAgent` is updated to populate these new `VictimProfile` fields in its `VictimProfile` output, based on the options it selected in Story 5.3.
- AC5: (If decision is YES and applies to suspects) The `SuspectGenerationAgent` (if modified for list-based attributes) is updated to populate these new fields.
- AC6: (If decision is YES) The final JSON output from the main script reflects these new fields when they are populated.

## Technical Implementation Context

**Guidance:** Use the following details for implementation. Developer agent is expected to follow project standards in `docs/coding-standards.md` and understand the project structure in `docs/project-structure.md`.

- **Relevant Files:**
  - Files to Create: None.
  - Files to Modify (If decision is YES):
    - `src/mystery_ai/core/data_models.py` (for `VictimProfile`, `SuspectProfile`)
    - `src/mystery_ai/agents/case_initializer.py`
    - Potentially `src/mystery_ai/agents/suspect_generator.py`
- **Key Technologies:**
  - Python, Pydantic.
- **API Interactions / SDK Usage:**
  - N/A
- **UI/UX Notes:**
  - N/A
- **Data Structures:**
  - (If YES) New `Optional[str]` fields added to `VictimProfile` / `SuspectProfile`.
- **Environment Variables:**
  - None.
- **Coding Standards Notes:**
  - Follow Pydantic best practices for model definitions.

## Testing Requirements

**Guidance:** Verify implementation against the ACs using the following tests.

- **Unit Tests (If decision is YES):**
  - Test Pydantic model serialization/deserialization with new optional fields.
- **Integration Tests (If decision is YES):**
  - Verify that agents correctly populate the new fields.
  - Verify that the main orchestrator output includes these fields in the final JSON.
- **Manual/CLI Verification:**
  - Document the decision (AC1).
  - (If YES) Inspect JSON output to confirm new fields are present and correctly populated.

## Tasks / Subtasks

- [ ] Task 1: Team discussion: Is explicit tracking of chosen attribute categories in data models needed?
- [ ] Task 2: Document the decision made in Task 1.
- [ ] Task 3: (If YES to Task 1) Add `chosen_cause_of_death_category: Optional[str]` to `VictimProfile`.
- [ ] Task 4: (If YES to Task 1) Add `chosen_motive_category: Optional[str]` to `VictimProfile`.
- [ ] Task 5: (If YES to Task 1) Add `chosen_occupation_archetype: Optional[str]` to `VictimProfile`.
- [ ] Task 6: (If YES to Task 1) Add `chosen_personality_archetype: Optional[str]` to `VictimProfile`.
- [ ] Task 7: (If YES to Task 1 and applicable to suspects) Update `SuspectProfile` similarly.
- [ ] Task 8: (If YES to Task 1) Modify `CaseInitializationAgent` to populate the new `VictimProfile` fields with the category name it selected.
- [ ] Task 9: (If YES to Task 1 and applicable to suspects) Modify `SuspectGenerationAgent` similarly.
- [ ] Task 10: (If YES to Task 1) Update relevant tests.
- [ ] Task 11: Verify all applicable Acceptance Criteria are met.

## Story Wrap Up (Agent Populates After Execution)

- **Agent Model Used:** `<Agent Model Name/Version>`
- **Completion Notes:** {Record the decision from Task 1 here. Detail any changes made if YES.}
- **Change Log:**
  - Initial Draft 